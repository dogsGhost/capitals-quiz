(function(){var t;t={init:function(){return this.cacheVariables(),this.bindQuizList()},cacheVariables:function(){this.quizFormTemplate=Handlebars.compile($("#quiz-form-template").html()),this.resultsTemplate=Handlebars.compile($("#results-template").html()),this.$container=$(".container"),this.$initContent=[],this.$quizForm=$("#quiz-form"),this.answerKey=[],this.userAnswers=[],this.numberAnswered=0,this.totalQuestions=0,this.invalidForm=!1,this.qSetLength=3},bindQuizList:function(){return $("#quizList").on("click","a",this.determineQuiz)},determineQuiz:function(e){return e.preventDefault(),"usa"===this.id?$.getJSON("js/statesAnswerKey.json",t.createAnswerKey):"canada"===this.id?!1:void 0},createAnswerKey:function(e){var i,n,s,r;for(i=t.shuffle(e),s=0,r=i.length;r>s;s++)n=i[s],n.cities=t.shuffle(n.cities),n.cities=n.cities.splice(2,2),n.cities.push(n.capital),n.cities=t.shuffle(n.cities);return t.answerKey=i,t.totalQuestions=t.answerKey.length,t.loadUsaQuiz()},loadUsaQuiz:function(){var t;return this.$initContent=this.$container.children().detach(),this.$container.append(this.$initContent[3]),t=this.createQuestionSet(),this.$quizForm.on("submit",this.processForm),this.$quizForm.find("div").html(t).end().show()},createQuestionSet:function(){var t;return t={states:this.answerKey.slice(this.numberAnswered,this.numberAnswered+this.qSetLength),answered:this.numberAnswered,total:this.totalQuestions,percentage:""+String(Math.round(this.numberAnswered/this.totalQuestions*100))+"%"},this.quizFormTemplate(t)},processForm:function(e){var i,n,s,r;if(e.preventDefault(),i=$(this).serializeArray(),t.validateForm(i),!t.invalidForm){for(s=0,r=i.length;r>s;s++)n=i[s],t.userAnswers.push(n);return t.numberAnswered+=t.qSetLength,t.numberAnswered>=t.totalQuestions?t.showResults():t.showNextSet(),t.toTop()}},validateForm:function(t){var e,i,n,s;for(this.invalidForm=!1,e="<div class='question__no-answer'> <p>Please select a capital for this state.</p> </div>",$(".question__no-answer").remove(),n=0,s=t.length;s>n;n++)i=t[n],i.value||($(".question--"+i.name).prepend(e),this.invalidForm=!0)},showNextSet:function(){var e;return e=this.createQuestionSet(),this.$quizForm.find("div").html(e),t.numberAnswered>=t.totalQuestions-t.qSetLength?this.$quizForm.find("input[type=submit]").val("View Results âž¡"):void 0},showResults:function(){var t,e,i,n,s,r,o,a,u,h;for(i={total:this.totalQuestions,wrong:[]},u=this.userAnswers,s=0,o=u.length;o>s;s++)for(t=u[s],h=this.answerKey,r=0,a=h.length;a>r;r++)if(n=h[r],t.name===n.abbr&&t.value!==n.capital){i.wrong.push(n);break}return i.correct=i.total-i.wrong.length,i.score=""+String(Math.round(i.correct/i.total*100))+"%",e=this.resultsTemplate(i),this.$quizForm.find("div").empty().end().remove(),this.$container.html(e),$(".btn--new-game").on("click",function(){return location.reload()})},shuffle:function(t){var e,i,n,s;if(e=t.length,0===e)return!1;for(;--e;)i=Math.floor(Math.random()*(e+1)),n=t[e],s=t[i],t[e]=s,t[i]=n;return t},toTop:function(){return navigator.userAgent.match(/(iPod|iPhone|iPad|Android)/)?window.scroll(0,0):$("html, body").animate({scrollTop:0},600)}},t.init()}).call(this);